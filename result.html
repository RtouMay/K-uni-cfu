<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†ØªÛŒØ¬Ù‡ Ø¢Ø²Ù…ÙˆÙ†</title>

    <style>
        @font-face {
            font-family: "YekanBakh";
            src: url("YekanBakh.woff2") format("woff2");
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: "YekanBakh", sans-serif;
            background: radial-gradient(circle at top, #222, #050509 50%, #000 100%);
            color: #f6f6f6;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .card {
            max-width: 900px;
            width: 100%;
            background: linear-gradient(145deg, #0d0d12, #050509);
            border-radius: 24px;
            padding: 30px 24px;
            box-shadow: 0 18px 60px rgba(0,0,0,.9);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: "";
            position: absolute;
            inset: -40%;
            background:
                radial-gradient(circle at 0 0, rgba(245,200,66,.08), transparent 55%),
                radial-gradient(circle at 100% 100%, rgba(255,255,255,.06), transparent 55%);
            opacity: .6;
        }

        .inside {
            position: relative;
            z-index: 2;
        }

        h1 {
            text-align: center;
            margin: 0 0 18px;
            font-size: 22px;
            color: #f5c842;
        }

        .summary {
            background: #111;
            padding: 20px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,.06);
            margin-bottom: 20px;
        }

        .summary-item {
            font-size: 15px;
            margin: 8px 0;
        }

        .percent {
            font-size: 48px;
            font-weight: 700;
            text-align: center;
            margin: 20px 0;
            color: #f5c842;
            opacity: 0;          /* Ø¨Ø±Ø§ÛŒ Ø§Ù†ÛŒÙ…ÛŒØ´Ù† */
            transform: scale(0.8);
        }

        .psychology {
            margin-top: 20px;
            padding: 18px;
            background: #1a1a1a;
            border-radius: 14px;
            border: 1px solid rgba(255,255,255,.08);
            font-size: 15px;
            line-height: 1.8;
        }

        .title-small {
            font-size: 15px;
            font-weight: 600;
            margin: 0 0 8px;
        }

        .badge-box {
            margin-top: 20px;
            background: #151515;
            padding: 14px 20px;
            border-radius: 14px;
            border: 1px solid rgba(255,255,255,.08);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge-icon {
            font-size: 28px;
        }

        .badge-title {
            font-size: 17px;
            font-weight: 600;
            color: #ffd86b;
        }

        .btn {
            padding: 10px 18px;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            font-family: inherit;
            margin: 10px 5px;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #f5c842, #f0a900);
            color: #1d1203;
            font-weight: 700;
        }

        .btn-secondary {
            background: #222;
            color: #ddd;
        }

        .btn-tertiary {
            background: transparent;
            color: #bbb;
            font-size: 12px;
        }

        .buttons-center {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>

<body>

<div class="card">
    <div class="inside">

        <h1>Ù†ØªÛŒØ¬Ù‡ Ø¢Ø²Ù…ÙˆÙ†</h1>

        <div class="summary">
            <div class="summary-item">ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø±Ø³Øª: <span id="correctBox"></span></div>
            <div class="summary-item">ØªØ¹Ø¯Ø§Ø¯ ØºÙ„Ø·: <span id="wrongBox"></span></div>
            <div class="summary-item">Ø²Ù…Ø§Ù† Ø¢Ø²Ù…ÙˆÙ†: <span id="timeBox"></span></div>
        </div>

        <div id="percentBox" class="percent">0%</div>

        <!-- Ù„Ù‚Ø¨ -->
        <div class="badge-box">
            <div class="badge-icon">ğŸ…</div>
            <div class="badge-title" id="userRank">...</div>
        </div>

        <!-- ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ -->
        <div class="psychology" id="psychologyBox"></div>

        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ -->
        <div class="buttons-center">
            <button id="retryBtn" class="btn btn-primary">Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¢Ø²Ù…ÙˆÙ† Ù‡Ù…ÛŒÙ† Ø¯Ø±Ø³</button>
            <button id="wrongBtn" class="btn btn-secondary">ÙÙ‚Ø· Ø³ÙˆØ§Ù„Ø§Øª ØºÙ„Ø·</button>
            <button id="backBtn" class="btn btn-tertiary">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯Ø±Ø³â€ŒÙ‡Ø§</button>
        </div>

    </div>
</div>

<script>
    const username = localStorage.getItem("konkur_username");

    const correct = Number(localStorage.getItem("quiz_correct"));
    const wrong = Number(localStorage.getItem("quiz_wrong"));
    const time = Number(localStorage.getItem("quiz_time"));

    document.getElementById("correctBox").textContent = correct;
    document.getElementById("wrongBox").textContent = wrong;

    // ØªØ¨Ø¯ÛŒÙ„ Ø²Ù…Ø§Ù†
    let m = String(Math.floor(time / 60)).padStart(2,"0");
    let s = String(time % 60).padStart(2,"0");
    document.getElementById("timeBox").textContent = `${m}:${s}`;

    const percent = Math.round((correct / (correct + wrong)) * 100);
    const percentBox = document.getElementById("percentBox");

    // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¯Ø±ØµØ¯
    let p = 0;
    let anim = setInterval(() => {
        p++;
        percentBox.textContent = p + "%";
        percentBox.style.opacity = "1";
        percentBox.style.transform = "scale(1)";
        if (p >= percent) clearInterval(anim);
    }, 15);

    /* ------------------------------------
       Ù„Ù‚Ø¨â€ŒÙ‡Ø§ â€” Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ ØªØ³Øªâ€ŒÙ‡Ø§
    ------------------------------------ */
    const totalKey = `total_tests_${username}`;
    const totalTests = Number(localStorage.getItem(totalKey) || "0");

    function getRank(t) {
        if (t >= 1000) return "Ø§ÙØ³Ø§Ù†Ù‡ ØªØ³Øªâ€ŒØ²Ù†ÛŒ ğŸ”¥";
        if (t >= 600) return "Ø¨Ø²Ø±Ú¯ ØªØ³Øªâ€ŒØ²Ù† ğŸ’›";
        if (t >= 400) return "ØªØ³Øªâ€ŒØ²Ù† Ù‚Ù‡Ø§Ø± âš¡";
        if (t >= 200) return "ØªØ³Øªâ€ŒØ²Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ğŸ¯";
        if (t >= 100) return "ØªØ³Øªâ€ŒØ²Ù† ÙØ¹Ø§Ù„ ğŸš€";
        if (t >= 50)  return "Ø¯Ø± Ù…Ø³ÛŒØ± ØªØ³Øªâ€ŒØ²Ù†ÛŒ âœ¨";
        if (t >= 20)  return "Ø´Ø±ÙˆØ¹ Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ ğŸ’ª";
        return "ØªØ§Ø²Ù‡â€ŒÙˆØ§Ø±Ø¯ ØªØ³Øªâ€ŒØ²Ù† ğŸŒ±";
    }

    const rankName = getRank(totalTests);
    document.getElementById("userRank").textContent = rankName;

    /* ------------------------------------
       ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…Ù‡Ø±Ø¨Ø§Ù† + Ù†ÛŒÙ…Ù‡ Ø±Ø³Ù…ÛŒ
    ------------------------------------ */
    const psychologyBox = document.getElementById("psychologyBox");

    function psychText(percent) {
        if (percent >= 85) {
            return "Ø¹Ù…Ù„Ú©Ø±Ø¯Øª ÙÙˆÙ‚â€ŒØ§Ù„Ø¹Ø§Ø¯Ù‡â€ŒØ³! ğŸ‘ ØªØ³Ù„Ø· Ø®ÙˆØ¨ÛŒ Ø±ÙˆÛŒ Ø§ÛŒÙ† Ø¯Ø±Ø³ Ø¯Ø§Ø±ÛŒ. Ø§Ø¯Ø§Ù…Ù‡ Ù‡Ù…ÛŒÙ† Ø±ÙˆÙ†Ø¯ Ø¨Ø§Ø¹Ø« Ù…ÛŒâ€ŒØ´Ù‡ Ù†ØªÛŒØ¬Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÛŒÙ„ÛŒ Ø¨Ù‡ØªØ±ÛŒ Ø¨Ú¯ÛŒØ±ÛŒ.";
        }
        if (percent >= 60) {
            return "Ø®ÛŒÙ„ÛŒ Ø®ÙˆØ¨ Ø¨ÙˆØ¯! ğŸ™‚ Ù¾Ø§ÛŒÙ‡â€ŒØª Ù‚ÙˆÛŒÙ‡ Ùˆ ÙÙ‚Ø· Ú©Ù…ÛŒ ØªÙ…Ø±ÛŒÙ† Ø¨ÛŒØ´ØªØ± Ù…ÛŒâ€ŒØªÙˆÙ†Ù‡ ØªÙˆ Ø±Ùˆ Ø¨Ù‡ Ø³Ø·Ø­ Ø¨Ø§Ù„Ø§ØªØ± Ø¨Ø±Ø³ÙˆÙ†Ù‡. Ù‡Ù…ÛŒÙ† Ù…Ø³ÛŒØ± Ø±Ùˆ Ø¨Ø±Ùˆ.";
        }
        if (percent >= 40) {
            return "Ø¹Ù…Ù„Ú©Ø±Ø¯Øª Ù…ØªÙˆØ³Ø·Ù‡ ÙˆÙ„ÛŒ Ù†Ø´ÙˆÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø®ÙˆØ¨ÛŒ Ø¯ÛŒØ¯Ù‡ Ù…ÛŒâ€ŒØ´Ù‡. Ø¨Ø§ ØªÚ©Ø±Ø§Ø± ØªØ³Øªâ€ŒÙ‡Ø§ Ùˆ Ù…Ø±ÙˆØ± Ù†Ú©Ø§ØªØŒ Ø®ÛŒÙ„ÛŒ Ø³Ø±ÛŒØ¹ Ø±Ø´Ø¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒ. Ù†Ø§Ø§Ù…ÛŒØ¯ Ù†Ø´Ùˆ ğŸŒ±";
        }
        return "Ù†ØªÛŒØ¬Ù‡â€ŒØª Ù‚Ø§Ø¨Ù„ Ø¨Ù‡ØªØ± Ø´Ø¯Ù†Ù‡ØŒ ÙˆÙ„ÛŒ Ø¬Ø§ÛŒ Ù†Ú¯Ø±Ø§Ù†ÛŒ Ù†ÛŒØ³Øª. Ù‡Ø± Ø¢Ø²Ù…ÙˆÙ† ÛŒÚ© Ù‚Ø¯Ù…Ù‡ Ø¨Ù‡ Ø³Ù…Øª Ù¾ÛŒØ´Ø±ÙØª. Ø¨Ø§ ØªÙ…Ø±ÛŒÙ†â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ø¸Ù… Ø®ÛŒÙ„ÛŒ Ø³Ø±ÛŒØ¹ Ø¨Ù‡ØªØ± Ù…ÛŒâ€ŒØ´ÛŒ ğŸ™Œ";
    }

    psychologyBox.textContent = psychText(percent);

    /* ------------------------------------
         Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
    ------------------------------------ */

    // Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¢Ø²Ù…ÙˆÙ†
    document.getElementById("retryBtn").addEventListener("click", () => {
        localStorage.removeItem("review_wrong_mode");
        window.location.href = "questions-count.html";
    });

    // ÙÙ‚Ø· ØºÙ„Ø·â€ŒÙ‡Ø§
    document.getElementById("wrongBtn").addEventListener("click", () => {
        localStorage.setItem("review_wrong_mode", "yes");
        window.location.href = "quiz.html";
    });

    // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯Ø±Ø³â€ŒÙ‡Ø§
    document.getElementById("backBtn").addEventListener("click", () => {
        window.location.href = "subjects.html";
    });
</script>

</body>
</html>
