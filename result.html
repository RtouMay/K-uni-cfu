<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†ØªÛŒØ¬Ù‡ Ø¢Ø²Ù…ÙˆÙ†</title>

    <style>
        @font-face {
            font-family: "YekanBakh";
            src: url("YekanBakh.woff2") format("woff2");
        }

        * { box-sizing: border-box; }

        :root {
            --bg-body: radial-gradient(circle at top, #222, #050509 50%, #000 100%);
            --text-main: #f6f6f6;
            --card-bg: linear-gradient(145deg, #0d0d12, #050509);
            --card-shadow: 0 18px 60px rgba(0,0,0,.9);
            --box-bg: #111;
            --soft-border: rgba(255,255,255,.06);
        }

        body[data-theme="light"] {
            --bg-body: radial-gradient(circle at top, #ffffff, #f4f4f4 55%, #e0e0e0 100%);
            --text-main: #222;
            --card-bg: #ffffff;
            --card-shadow: 0 14px 40px rgba(0,0,0,.12);
            --box-bg: #f7f7f7;
            --soft-border: rgba(0,0,0,.06);
        }

        body {
            margin: 0;
            min-height: 100vh;
            font-family: "YekanBakh", sans-serif;
            background: var(--bg-body);
            color: var(--text-main);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            transition: background .3s ease, color .3s ease;
        }

        .card {
            max-width: 900px;
            width: 100%;
            background: var(--card-bg);
            border-radius: 24px;
            padding: 24px 20px;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
            transition: background .3s ease, box-shadow .3s ease;
        }

        .card::before {
            content: "";
            position: absolute;
            inset: -40%;
            background:
                radial-gradient(circle at 0 0, rgba(245,200,66,.08), transparent 55%),
                radial-gradient(circle at 100% 100%, rgba(255,255,255,.06), transparent 55%);
            opacity: .6;
        }

        .inside {
            position: relative;
            z-index: 2;
        }

        .top-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 12px;
        }

        h1 {
            text-align: left;
            margin: 0;
            font-size: 20px;
            color: #f5c842;
        }

        body[data-theme="light"] h1 {
            color: #c59500;
        }

        .theme-toggle {
            border: 1px solid var(--soft-border);
            background: transparent;
            color: inherit;
            border-radius: 999px;
            padding: 6px 12px;
            font-family: inherit;
            font-size: 11px;
            cursor: pointer;
        }

        .summary {
            background: var(--box-bg);
            padding: 16px;
            border-radius: 16px;
            border: 1px solid var(--soft-border);
            margin-bottom: 18px;
        }

        .summary-item {
            font-size: 14px;
            margin: 6px 0;
        }

        .percent {
            font-size: 42px;
            font-weight: 700;
            text-align: center;
            margin: 14px 0 16px;
            color: #f5c842;
            opacity: 0;
            transform: scale(.8);
        }

        body[data-theme="light"] .percent {
            color: #c59500;
        }

        .badge-box {
            margin-top: 6px;
            background: var(--box-bg);
            padding: 12px 16px;
            border-radius: 14px;
            border: 1px solid var(--soft-border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge-icon {
            font-size: 26px;
        }

        .badge-title {
            font-size: 16px;
            font-weight: 600;
            color: #ffd86b;
        }

        body[data-theme="light"] .badge-title {
            color: #c28a00;
        }

        .psychology {
            margin-top: 16px;
            padding: 14px;
            background: var(--box-bg);
            border-radius: 14px;
            border: 1px solid var(--soft-border);
            font-size: 14px;
            line-height: 1.8;
        }

        .buttons-center {
            text-align: center;
            margin-top: 20px;
        }

        .btn {
            padding: 9px 16px;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            font-family: inherit;
            margin: 8px 5px;
            font-size: 13px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #f5c842, #f0a900);
            color: #1d1203;
            font-weight: 700;
        }

        .btn-secondary {
            background: #222;
            color: #ddd;
        }

        body[data-theme="light"] .btn-secondary {
            background: #f0f0f0;
            color: #222;
        }

        .btn-tertiary {
            background: transparent;
            color: #bbb;
            font-size: 12px;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .card {
                padding: 18px 14px;
                border-radius: 18px;
            }
            h1 {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>

<div class="card">
    <div class="inside">

        <div class="top-row">
            <h1>Ù†ØªÛŒØ¬Ù‡ Ø¢Ø²Ù…ÙˆÙ†</h1>
            <button id="themeToggle" class="theme-toggle">â˜€ï¸ Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†</button>
        </div>

        <div class="summary">
            <div class="summary-item">ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø±Ø³Øª: <span id="correctBox"></span></div>
            <div class="summary-item">ØªØ¹Ø¯Ø§Ø¯ ØºÙ„Ø·: <span id="wrongBox"></span></div>
            <div class="summary-item">Ø²Ù…Ø§Ù† Ø¢Ø²Ù…ÙˆÙ†: <span id="timeBox"></span></div>
        </div>

        <div id="percentBox" class="percent">0%</div>

        <div class="badge-box">
            <div class="badge-icon">ğŸ…</div>
            <div class="badge-title" id="userRank">...</div>
        </div>

        <div class="psychology" id="psychologyBox"></div>

        <div class="buttons-center">
            <button id="retryBtn" class="btn btn-primary">Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¢Ø²Ù…ÙˆÙ† Ù‡Ù…ÛŒÙ† Ø¯Ø±Ø³</button>
            <button id="wrongBtn" class="btn btn-secondary">ÙÙ‚Ø· Ø³ÙˆØ§Ù„Ø§Øª ØºÙ„Ø·</button>
            <button id="backBtn" class="btn btn-tertiary">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¯Ø±Ø³â€ŒÙ‡Ø§</button>
        </div>

    </div>
</div>

<script>
    /* ØªÙ… ØªØ§Ø±ÛŒÚ© / Ø±ÙˆØ´Ù† */
    const THEME_KEY = "konkur_theme";
    const themeToggleBtn = document.getElementById("themeToggle");

    function applyTheme(theme) {
        document.body.setAttribute("data-theme", theme);
        themeToggleBtn.textContent =
            theme === "light" ? "ğŸŒ™ Ø­Ø§Ù„Øª ØªÛŒØ±Ù‡" : "â˜€ï¸ Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù†";
    }

    const savedTheme = localStorage.getItem(THEME_KEY) || "dark";
    applyTheme(savedTheme);

    themeToggleBtn.addEventListener("click", () => {
        const current = document.body.getAttribute("data-theme") || "dark";
        const next = current === "dark" ? "light" : "dark";
        localStorage.setItem(THEME_KEY, next);
        applyTheme(next);
    });

    /* Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¢Ø²Ù…ÙˆÙ† */
    const username = localStorage.getItem("konkur_username");
    const correct = Number(localStorage.getItem("quiz_correct"));
    const wrong = Number(localStorage.getItem("quiz_wrong"));
    const time = Number(localStorage.getItem("quiz_time"));

    document.getElementById("correctBox").textContent = correct;
    document.getElementById("wrongBox").textContent = wrong;

    let m = String(Math.floor(time / 60)).padStart(2,"0");
    let s = String(time % 60).padStart(2,"0");
    document.getElementById("timeBox").textContent = `${m}:${s}`;

    const percent = Math.round((correct / (correct + wrong)) * 100);
    const percentBox = document.getElementById("percentBox");

    let p = 0;
    const anim = setInterval(() => {
        p++;
        percentBox.textContent = p + "%";
        percentBox.style.opacity = "1";
        percentBox.style.transform = "scale(1)";
        if (p >= percent) clearInterval(anim);
    }, 15);

    /* Ù„Ù‚Ø¨â€ŒÙ‡Ø§ */
    const totalKey = `total_tests_${username}`;
    const totalTests = Number(localStorage.getItem(totalKey) || "0");

    function getRank(t) {
        if (t >= 1000) return "Ø§ÙØ³Ø§Ù†Ù‡ ØªØ³Øªâ€ŒØ²Ù†ÛŒ ğŸ”¥";
        if (t >= 600) return "Ø¨Ø²Ø±Ú¯ ØªØ³Øªâ€ŒØ²Ù† ğŸ’›";
        if (t >= 400) return "ØªØ³Øªâ€ŒØ²Ù† Ù‚Ù‡Ø§Ø± âš¡";
        if (t >= 200) return "ØªØ³Øªâ€ŒØ²Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ğŸ¯";
        if (t >= 100) return "ØªØ³Øªâ€ŒØ²Ù† ÙØ¹Ø§Ù„ ğŸš€";
        if (t >= 50)  return "Ø¯Ø± Ù…Ø³ÛŒØ± ØªØ³Øªâ€ŒØ²Ù†ÛŒ âœ¨";
        if (t >= 20)  return "Ø´Ø±ÙˆØ¹ Ù‚Ø¯Ø±ØªÙ…Ù†Ø¯ ğŸ’ª";
        return "ØªØ§Ø²Ù‡â€ŒÙˆØ§Ø±Ø¯ ØªØ³Øªâ€ŒØ²Ù† ğŸŒ±";
    }

    const rankName = getRank(totalTests);
    document.getElementById("userRank").textContent = rankName;

    /* ØªØ­Ù„ÛŒÙ„ Ø±ÙˆØ§Ù†Ø´Ù†Ø§Ø³ÛŒ Ù…Ù‡Ø±Ø¨Ø§Ù† + Ù†ÛŒÙ…Ù‡â€Œ Ø±Ø³Ù…ÛŒ */
    const psychologyBox = document.getElementById("psychologyBox");

    function psychText(percent) {
        if (!Number.isFinite(percent)) {
            return "Ø¢Ø²Ù…ÙˆÙ† Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³ØªØŒ Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ø¢Ø²Ù…ÙˆÙ† Ø¬Ø¯ÛŒØ¯ Ø§Ø¬Ø±Ø§ Ú©Ù†.";
        }
        if (percent >= 85) {
            return "Ø¹Ù…Ù„Ú©Ø±Ø¯Øª Ø¨Ø³ÛŒØ§Ø± Ø¹Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù‡ Ø§Ø³Øª ğŸ‘ ØªØ³Ù„Ø· Ø®ÙˆØ¨ÛŒ Ø±ÙˆÛŒ Ø§ÛŒÙ† Ø¯Ø±Ø³ Ø¯Ø§Ø±ÛŒ. Ø§Ø¯Ø§Ù…Ù‡â€ŒÛŒ Ù‡Ù…ÛŒÙ† Ø±ÙˆÙ†Ø¯ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ØªÙˆ Ø±Ø§ Ø¨Ù‡ Ù†ØªØ§ÛŒØ¬ Ø¨Ø³ÛŒØ§Ø± Ø®ÙˆØ¨ÛŒ Ø¨Ø±Ø³Ø§Ù†Ø¯.";
        }
        if (percent >= 60) {
            return "Ø¹Ù…Ù„Ú©Ø±Ø¯Øª Ø®ÙˆØ¨ Ùˆ Ø§Ù…ÛŒØ¯ÙˆØ§Ø±Ú©Ù†Ù†Ø¯Ù‡ Ø§Ø³Øª ğŸ™‚ Ù¾Ø§ÛŒÙ‡â€ŒÛŒ Ù…Ù†Ø§Ø³Ø¨ÛŒ Ø¯Ø§Ø±ÛŒ Ùˆ Ø¨Ø§ Ú©Ù…ÛŒ ØªÙ…Ø±ÛŒÙ† Ùˆ Ù…Ø±ÙˆØ± Ø¨ÛŒØ´ØªØ±ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒ Ø³Ø·Ø­ Ø®ÙˆØ¯Øª Ø±Ø§ Ø¨Ø§Ù„Ø§ØªØ± Ø¨Ø¨Ø±ÛŒ.";
        }
        if (percent >= 40) {
            return "Ø¹Ù…Ù„Ú©Ø±Ø¯Øª Ø¯Ø± Ø­Ø¯ Ù…ØªÙˆØ³Ø· Ø§Ø³ØªØŒ Ø§Ù…Ø§ Ù†Ø´Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØª Ø¯Ø± Ú©Ø§Ø±Øª Ø¯ÛŒØ¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø¨Ø§ ØªÚ©Ø±Ø§Ø± ØªØ³Øªâ€ŒÙ‡Ø§ Ùˆ ØªÙ…Ø±ÛŒÙ† Ù…Ù†Ø¸Ù…ØŒ Ø¨Ù‡â€ŒÙ…Ø±ÙˆØ± Ù†ØªÛŒØ¬Ù‡â€ŒÙ‡Ø§ÛŒØª Ø¨Ù‡ØªØ± Ù…ÛŒâ€ŒØ´ÙˆØ¯ ğŸŒ±";
        }
        return "Ø§ÛŒÙ† Ø¨Ø§Ø± Ù†ØªÛŒØ¬Ù‡â€ŒØ§Øª Ú©Ù…ØªØ± Ø§Ø² Ú†ÛŒØ²ÛŒ Ø§Ø³Øª Ú©Ù‡ ØªÙˆØ§Ù† ÙˆØ§Ù‚Ø¹ÛŒâ€ŒØ§Øª Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ØŒ Ø§Ù…Ø§ Ø¬Ø§ÛŒ Ù†Ú¯Ø±Ø§Ù†ÛŒ Ù†ÛŒØ³Øª. Ù‡Ø± Ø¢Ø²Ù…ÙˆÙ† ÛŒÚ© Ù‚Ø¯Ù… Ø¨Ù‡ Ø³Ù…Øª Ù¾ÛŒØ´Ø±ÙØª Ø§Ø³Øª. Ø¨Ø§ ØªÙ…Ø±ÛŒÙ† Ø¨ÛŒØ´ØªØ± Ùˆ Ù…Ø±ÙˆØ± Ø¢Ø±Ø§Ù…ØŒ Ø¨Ù‡â€ŒØªØ¯Ø±ÛŒØ¬ Ù¾ÛŒØ´Ø±ÙØª Ø±Ø§ Ø­Ø³ Ù…ÛŒâ€ŒÚ©Ù†ÛŒ ğŸ™Œ";
    }

    psychologyBox.textContent = psychText(percent);

    /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
    document.getElementById("retryBtn").addEventListener("click", () => {
        localStorage.removeItem("review_wrong_mode");
        window.location.href = "questions-count.html";
    });

    document.getElementById("wrongBtn").addEventListener("click", () => {
        localStorage.setItem("review_wrong_mode", "yes");
        window.location.href = "quiz.html";
    });

    document.getElementById("backBtn").addEventListener("click", () => {
        window.location.href = "subjects.html";
    });
</script>

</body>
</html>
